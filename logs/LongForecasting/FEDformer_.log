Args in experiment:
Namespace(L=3, activation='gelu', base='legendre', batch_size=32, c_out=1, checkpoints='./checkpoints/', cross_activation='tanh', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='ai_competition_nonan.csv', dec_in=1, des='Exp', devices='0,1', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=1, factor=3, features='S', freq='h', gpu=0, is_training=1, itr=1, label_len=30, learning_rate=0.0001, loss='mse', lradj='type1', mode_select='random', model='FEDformer', modes=64, moving_avg=[24], n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=30, root_path='../dataset', seq_len=60, target='OT', task_id='Test1', train_epochs=10, use_amp=False, use_gpu=False, use_multi_gpu=False, version='Fourier')
Use CPU
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
fourier enhanced block used!
modes=64, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
 fourier enhanced cross attention used!
modes_q=30, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
modes_kv=30, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]
enc_modes: 30, dec_modes: 30
>>>>>>>start training : Test1_FEDformer_random_modes64_custom_ftS_sl60_ll30_pl30_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 2944
val 406
test 837
Epoch: 1 cost time: 622.9878480434418
Epoch: 1, Steps: 92 | Train Loss: 0.3822652 Vali Loss: 0.0690910 Test Loss: 1.0839323
Validation loss decreased (inf --> 0.069091).  Saving model ...
Updating learning rate to 0.0001
Epoch: 2 cost time: 609.4349489212036
Epoch: 2, Steps: 92 | Train Loss: 0.3482613 Vali Loss: 0.0786366 Test Loss: 1.0735978
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
Epoch: 3 cost time: 609.5293550491333
Epoch: 3, Steps: 92 | Train Loss: 0.3338492 Vali Loss: 0.0807818 Test Loss: 1.0690540
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
Epoch: 4 cost time: 609.7085030078888
Epoch: 4, Steps: 92 | Train Loss: 0.3269964 Vali Loss: 0.0746054 Test Loss: 1.0573881
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Test1_FEDformer_random_modes64_custom_ftS_sl60_ll30_pl30_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 837
test shape: (26, 32, 30, 1) (26, 32, 30, 1)
test shape: (832, 30, 1) (832, 30, 1)
mse:1.0839322805404663, mae:0.6644541621208191
